[2022-06-19 20:10:53,297] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: test.my_etl manual__2022-06-19T20:10:52.222884+00:00 [queued]>
[2022-06-19 20:10:53,311] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: test.my_etl manual__2022-06-19T20:10:52.222884+00:00 [queued]>
[2022-06-19 20:10:53,311] {taskinstance.py:1356} INFO - 
--------------------------------------------------------------------------------
[2022-06-19 20:10:53,311] {taskinstance.py:1357} INFO - Starting attempt 1 of 2
[2022-06-19 20:10:53,311] {taskinstance.py:1358} INFO - 
--------------------------------------------------------------------------------
[2022-06-19 20:10:53,423] {taskinstance.py:1377} INFO - Executing <Task(PythonOperator): my_etl> on 2022-06-19 20:10:52.222884+00:00
[2022-06-19 20:10:53,429] {standard_task_runner.py:52} INFO - Started process 7916 to run task
[2022-06-19 20:10:53,435] {standard_task_runner.py:79} INFO - Running: ['***', 'tasks', 'run', 'test', 'my_etl', 'manual__2022-06-19T20:10:52.222884+00:00', '--job-id', '224', '--raw', '--subdir', 'DAGS_FOLDER/test-dag.py', '--cfg-path', '/tmp/tmpvc2h9dzy', '--error-file', '/tmp/tmpn146p6sf']
[2022-06-19 20:10:53,436] {standard_task_runner.py:80} INFO - Job 224: Subtask my_etl
[2022-06-19 20:10:53,536] {task_command.py:370} INFO - Running <TaskInstance: test.my_etl manual__2022-06-19T20:10:52.222884+00:00 [running]> on host ca189b65812b
[2022-06-19 20:10:53,668] {taskinstance.py:1571} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=test
AIRFLOW_CTX_TASK_ID=my_etl
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T20:10:52.222884+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=manual__2022-06-19T20:10:52.222884+00:00
[2022-06-19 20:11:02,790] {logging_mixin.py:115} INFO -                                                 title  ...                                                url
0                      newSoftware Engineering Intern  ...  https://ca.indeed.com/rc/clk?jk=ff663ba3d6b730...
1                 newSoftware Engineer - Intern/Co-op  ...  https://ca.indeed.com/rc/clk?jk=0ee1559c24a34e...
2                           Software Developer Intern  ...  https://ca.indeed.com/rc/clk?jk=92e75e59e3c0a0...
3                           Intern, Software Engineer  ...  https://ca.indeed.com/rc/clk?jk=344a8a2ea0b60d...
4                            Software Engineer Intern  ...  https://ca.indeed.com/company/Rocket-Science-D...
5             Software Development Engineering Intern  ...  https://ca.indeed.com/rc/clk?jk=b37f5967ce21e3...
6            Software Developer Intern, MS, Fall 2022  ...  https://ca.indeed.com/rc/clk?jk=f0c2273cc6ed69...
7            newSoftware Developer Intern (16 months)  ...  https://ca.indeed.com/rc/clk?jk=f0fb76ffbb7377...
8               newJunior Software Developer - Intern  ...  https://ca.indeed.com/company/Convverge-Inc./j...
9                         Software Engineering Intern  ...  https://ca.indeed.com/rc/clk?jk=9868590178c109...
10      newSoftware Developer Intern/Coop - Fall 2022  ...  https://ca.indeed.com/rc/clk?jk=a1975e7f0d2b81...
11  Summer Intern: Professional Services Software ...  ...  https://ca.indeed.com/rc/clk?jk=58bb07dfc3229f...
12                 Software Development Intern - Dash  ...  https://ca.indeed.com/rc/clk?jk=18d2d9e3922781...
13                        Software engineering intern  ...  https://ca.indeed.com/rc/clk?jk=1efee23cac8d06...
14                        Software Engineering Intern  ...  https://ca.indeed.com/rc/clk?jk=fdd23c194a1ec6...

[15 rows x 6 columns]
[2022-06-19 20:11:02,814] {taskinstance.py:1889} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1686, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 909, in do_executemany
    **kwargs
  File "/home/airflow/.local/lib/python3.7/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "jobinfo_pkey"
DETAIL:  Key (url)=(https://ca.indeed.com/rc/clk?jk=ff663ba3d6b730be&fccid=d59215ef88e83b80&vjs=3) already exists.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/job_etl.py", line 100, in run_job_etl
    data.to_sql("jobinfo", engine, index=False, if_exists='append')
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/generic.py", line 2882, in to_sql
    method=method,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 728, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1770, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1350, in insert_records
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1340, in insert_records
    table.insert(chunksize=chunksize, method=method)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 967, in insert
    exec_insert(conn, keys, chunk_iter)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 882, in _execute_insert
    conn.execute(self.table.insert(), data)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/elements.py", line 314, in _execute_on_connection
    self, multiparams, params, execution_options
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1399, in _execute_clauseelement
    cache_hit=cache_hit,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1749, in _execute_context
    e, statement, parameters, cursor, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1930, in _handle_dbapi_exception
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1686, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 909, in do_executemany
    **kwargs
  File "/home/airflow/.local/lib/python3.7/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.IntegrityError: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "jobinfo_pkey"
DETAIL:  Key (url)=(https://ca.indeed.com/rc/clk?jk=ff663ba3d6b730be&fccid=d59215ef88e83b80&vjs=3) already exists.

[SQL: INSERT INTO jobinfo (title, location, compname, salary, jobdesc, url) VALUES (%(title)s, %(location)s, %(compname)s, %(salary)s, %(jobdesc)s, %(url)s)]
[parameters: ({'title': 'newSoftware Engineering Intern', 'location': 'Toronto, ON', 'compname': 'Texas Instruments', 'salary': 'N/A', 'jobdesc': '\n As a global semiconductor company operating in 35 countries, Texas Instruments (TI) is first and foremost a reflection of its people. From the TIe ... (2535 characters truncated) ... n\nFamiliarity with assembly language programming \n\n\n\nKnowledge of software engineering processes and the full software development lifecycle\n\n', 'url': 'https://ca.indeed.com/rc/clk?jk=ff663ba3d6b730be&fccid=d59215ef88e83b80&vjs=3'}, {'title': 'newSoftware Engineer - Intern/Co-op', 'location': 'Hybrid remote in Toronto, ON', 'compname': 'Intel', 'salary': 'N/A', 'jobdesc': "\nJob Description\n Come intern with one of the largest electrical engineering companies in the world.  Come Intern with our Programmable Solutions G ... (2045 characters truncated) ... ture of accessibility. Intel provides accommodations to applicants and employees with disabilities. Find information and request accommodation here\n", 'url': 'https://ca.indeed.com/rc/clk?jk=0ee1559c24a34e9f&fccid=936367796261bd6e&vjs=3'}, {'title': 'Software Developer Intern', 'location': 'Remote in Canada+1 location', 'compname': 'Oracle', 'salary': 'N/A', 'jobdesc': "\n\n  Software Developer Intern -220009AF\n  \n\n\n\n Applicants are required to read, write, and speak the following languages\n: English\n  \n\n\n\ ... (4565 characters truncated) ... the Fair Labor Standards Act.\n  \n\n\n\n\n\nJob: Product Development\n Location: Canada\n Job Type: Temporary Employee Hire\n Organization: Oracle\n", 'url': 'https://ca.indeed.com/rc/clk?jk=92e75e59e3c0a08b&fccid=cd22d01053af7669&vjs=3'}, {'title': 'Intern, Software Engineer', 'location': 'Remote in Toronto, ON', 'compname': 'Autodesk', 'salary': 'N/A', 'jobdesc': "\n\n  Position Overview\n \n\n   The Business Process Team is looking for a driven and naturally curious Software Engineer Intern who can hit the gro ... (2454 characters truncated) ... open jobs and apply internally (not on this external site). If you have any questions or require support, contact \n  \n   Autodesk Careers\n  .\n \n", 'url': 'https://ca.indeed.com/rc/clk?jk=344a8a2ea0b60dfa&fccid=7136762d065a5ad7&vjs=3'}, {'title': 'Software Engineer Intern', 'location': 'Montréal, QC', 'compname': 'Rocket Science Development', 'salary': 'N/A', 'jobdesc': '**This internship is only open to Canadian Citizens & Permanent Residents**\nThis is a three-month summer internship with the opportunity to continue ... (1192 characters truncated) ... nths\nBenefits:\n\nWork from home\n\nSchedule:\n\nMonday to Friday\n\nApplication question(s):\n\nAre you a Canadian Citizen or Permanent Resident?\n', 'url': 'https://ca.indeed.com/company/Rocket-Science-Development/jobs/Software-Engineer-Intern-ecf9c02f349a143d?fccid=14e48a4ab005a62c&vjs=3'}, {'title': 'Software Development Engineering Intern', 'location': 'Remote in Toronto, ON+8 locations', 'compname': 'fabric Inc.', 'salary': 'N/A', 'jobdesc': '\nJob Title: Software Development Engineering Intern\n Department: Engineering\n Location: Remote, Canada\n Start Date: June/July\n Who we are:\n Ima ... (4265 characters truncated) ... rties, unless the employee requests and is granted an accommodation. Questions about this requirement should be addressed to fabric\'s People team.\n', 'url': 'https://ca.indeed.com/rc/clk?jk=b37f5967ce21e39e&fccid=29f1ae1e76c4b817&vjs=3'}, {'title': 'Software Developer Intern, MS, Fall 2022', 'location': 'Hybrid remote in Montréal, QC', 'compname': 'Google', 'salary': 'N/A', 'jobdesc': "\nYou can submit your application for this role starting May 9, 2022. Please complete your application before July 2, 2022.\n Participation in the in ... (5166 characters truncated) ... Law. If you have a disability or special need that requires accommodation, please let us know by completing our Accommodations for Applicants form.\n", 'url': 'https://ca.indeed.com/rc/clk?jk=f0c2273cc6ed6968&fccid=a5b4499d9e91a5c6&vjs=3'}, {'title': 'newSoftware Developer Intern (16 months)', 'location': 'Markham, ON', 'compname': 'IBM', 'salary': 'N/A', 'jobdesc': "\n\nIntroduction\n At IBM, work is more than a job - it's a calling: To build. To design. To code. To consult. To think along with clients and sell.  ... (6826 characters truncated) ... , or other characteristics. IBM is also committed to compliance with all fair employment practices regarding citizenship and immigration status.\n \n", 'url': 'https://ca.indeed.com/rc/clk?jk=f0fb76ffbb737731&fccid=de71a49b535e21cb&vjs=3'}  ... displaying 10 of 15 total bound parameter sets ...  {'title': 'Software engineering intern', 'location': 'Dollard, QC', 'compname': 'Schneider Electric', 'salary': 'N/A', 'jobdesc': '\n Job Description: \n  We are seeking highly self-motivated, customer focused, team-oriented software/system engineer student to work for our System ... (3590 characters truncated) ...  or conduct. Concerning agencies: Schneider Electric does not accept unsolicited resumes and will not be responsible for fees related to such.\n \n\n', 'url': 'https://ca.indeed.com/rc/clk?jk=1efee23cac8d0608&fccid=8dc4399ddb463d4a&vjs=3'}, {'title': 'Software Engineering Intern', 'location': 'Remote in Montréal, QC+1 location', 'compname': 'Zendesk', 'salary': 'N/A', 'jobdesc': "Job Description \n\n Zendesk Conversations existe pour humaniser les interactions entre les entreprises et leurs clients. Nous alimentons des million ... (7126 characters truncated) ...  information, its purposes for processing your personal information, and the rights you can exercise over Zendesk’s use of your personal information.", 'url': 'https://ca.indeed.com/rc/clk?jk=fdd23c194a1ec64e&fccid=41e8f9abd9840a7a&vjs=3'})]
(Background on this error at: http://sqlalche.me/e/14/gkpj)
[2022-06-19 20:11:02,830] {taskinstance.py:1400} INFO - Marking task as UP_FOR_RETRY. dag_id=test, task_id=my_etl, execution_date=20220619T201052, start_date=20220619T201053, end_date=20220619T201102
[2022-06-19 20:11:02,865] {standard_task_runner.py:97} ERROR - Failed to execute job 224 for task my_etl ((psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "jobinfo_pkey"
DETAIL:  Key (url)=(https://ca.indeed.com/rc/clk?jk=ff663ba3d6b730be&fccid=d59215ef88e83b80&vjs=3) already exists.

[SQL: INSERT INTO jobinfo (title, location, compname, salary, jobdesc, url) VALUES (%(title)s, %(location)s, %(compname)s, %(salary)s, %(jobdesc)s, %(url)s)]
[parameters: ({'title': 'newSoftware Engineering Intern', 'location': 'Toronto, ON', 'compname': 'Texas Instruments', 'salary': 'N/A', 'jobdesc': '\n As a global semiconductor company operating in 35 countries, Texas Instruments (TI) is first and foremost a reflection of its people. From the TIe ... (2535 characters truncated) ... n\nFamiliarity with assembly language programming \n\n\n\nKnowledge of software engineering processes and the full software development lifecycle\n\n', 'url': 'https://ca.indeed.com/rc/clk?jk=ff663ba3d6b730be&fccid=d59215ef88e83b80&vjs=3'}, {'title': 'newSoftware Engineer - Intern/Co-op', 'location': 'Hybrid remote in Toronto, ON', 'compname': 'Intel', 'salary': 'N/A', 'jobdesc': "\nJob Description\n Come intern with one of the largest electrical engineering companies in the world.  Come Intern with our Programmable Solutions G ... (2045 characters truncated) ... ture of accessibility. Intel provides accommodations to applicants and employees with disabilities. Find information and request accommodation here\n", 'url': 'https://ca.indeed.com/rc/clk?jk=0ee1559c24a34e9f&fccid=936367796261bd6e&vjs=3'}, {'title': 'Software Developer Intern', 'location': 'Remote in Canada+1 location', 'compname': 'Oracle', 'salary': 'N/A', 'jobdesc': "\n\n  Software Developer Intern -220009AF\n  \n\n\n\n Applicants are required to read, write, and speak the following languages\n: English\n  \n\n\n\ ... (4565 characters truncated) ... the Fair Labor Standards Act.\n  \n\n\n\n\n\nJob: Product Development\n Location: Canada\n Job Type: Temporary Employee Hire\n Organization: Oracle\n", 'url': 'https://ca.indeed.com/rc/clk?jk=92e75e59e3c0a08b&fccid=cd22d01053af7669&vjs=3'}, {'title': 'Intern, Software Engineer', 'location': 'Remote in Toronto, ON', 'compname': 'Autodesk', 'salary': 'N/A', 'jobdesc': "\n\n  Position Overview\n \n\n   The Business Process Team is looking for a driven and naturally curious Software Engineer Intern who can hit the gro ... (2454 characters truncated) ... open jobs and apply internally (not on this external site). If you have any questions or require support, contact \n  \n   Autodesk Careers\n  .\n \n", 'url': 'https://ca.indeed.com/rc/clk?jk=344a8a2ea0b60dfa&fccid=7136762d065a5ad7&vjs=3'}, {'title': 'Software Engineer Intern', 'location': 'Montréal, QC', 'compname': 'Rocket Science Development', 'salary': 'N/A', 'jobdesc': '**This internship is only open to Canadian Citizens & Permanent Residents**\nThis is a three-month summer internship with the opportunity to continue ... (1192 characters truncated) ... nths\nBenefits:\n\nWork from home\n\nSchedule:\n\nMonday to Friday\n\nApplication question(s):\n\nAre you a Canadian Citizen or Permanent Resident?\n', 'url': 'https://ca.indeed.com/company/Rocket-Science-Development/jobs/Software-Engineer-Intern-ecf9c02f349a143d?fccid=14e48a4ab005a62c&vjs=3'}, {'title': 'Software Development Engineering Intern', 'location': 'Remote in Toronto, ON+8 locations', 'compname': 'fabric Inc.', 'salary': 'N/A', 'jobdesc': '\nJob Title: Software Development Engineering Intern\n Department: Engineering\n Location: Remote, Canada\n Start Date: June/July\n Who we are:\n Ima ... (4265 characters truncated) ... rties, unless the employee requests and is granted an accommodation. Questions about this requirement should be addressed to fabric\'s People team.\n', 'url': 'https://ca.indeed.com/rc/clk?jk=b37f5967ce21e39e&fccid=29f1ae1e76c4b817&vjs=3'}, {'title': 'Software Developer Intern, MS, Fall 2022', 'location': 'Hybrid remote in Montréal, QC', 'compname': 'Google', 'salary': 'N/A', 'jobdesc': "\nYou can submit your application for this role starting May 9, 2022. Please complete your application before July 2, 2022.\n Participation in the in ... (5166 characters truncated) ... Law. If you have a disability or special need that requires accommodation, please let us know by completing our Accommodations for Applicants form.\n", 'url': 'https://ca.indeed.com/rc/clk?jk=f0c2273cc6ed6968&fccid=a5b4499d9e91a5c6&vjs=3'}, {'title': 'newSoftware Developer Intern (16 months)', 'location': 'Markham, ON', 'compname': 'IBM', 'salary': 'N/A', 'jobdesc': "\n\nIntroduction\n At IBM, work is more than a job - it's a calling: To build. To design. To code. To consult. To think along with clients and sell.  ... (6826 characters truncated) ... , or other characteristics. IBM is also committed to compliance with all fair employment practices regarding citizenship and immigration status.\n \n", 'url': 'https://ca.indeed.com/rc/clk?jk=f0fb76ffbb737731&fccid=de71a49b535e21cb&vjs=3'}  ... displaying 10 of 15 total bound parameter sets ...  {'title': 'Software engineering intern', 'location': 'Dollard, QC', 'compname': 'Schneider Electric', 'salary': 'N/A', 'jobdesc': '\n Job Description: \n  We are seeking highly self-motivated, customer focused, team-oriented software/system engineer student to work for our System ... (3590 characters truncated) ...  or conduct. Concerning agencies: Schneider Electric does not accept unsolicited resumes and will not be responsible for fees related to such.\n \n\n', 'url': 'https://ca.indeed.com/rc/clk?jk=1efee23cac8d0608&fccid=8dc4399ddb463d4a&vjs=3'}, {'title': 'Software Engineering Intern', 'location': 'Remote in Montréal, QC+1 location', 'compname': 'Zendesk', 'salary': 'N/A', 'jobdesc': "Job Description \n\n Zendesk Conversations existe pour humaniser les interactions entre les entreprises et leurs clients. Nous alimentons des million ... (7126 characters truncated) ...  information, its purposes for processing your personal information, and the rights you can exercise over Zendesk’s use of your personal information.", 'url': 'https://ca.indeed.com/rc/clk?jk=fdd23c194a1ec64e&fccid=41e8f9abd9840a7a&vjs=3'})]
(Background on this error at: http://sqlalche.me/e/14/gkpj); 7916)
[2022-06-19 20:11:02,890] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-19 20:11:02,939] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
